<!DOCTYPE html>
<html>
  <head>
    <title>Parallel Core War</title>
    <meta charset="utf-8">
    <link rel="stylesheet" type="text/css" href="style.css">
    <script type="text/javascript" src="seedrandom.js"></script>
    <script type="text/javascript" src="color.js"></script>
    <script type="text/javascript" src="core.js"></script>
    <script type="text/javascript" src="rendercore.js"></script>
    <script type="text/javascript" src="index.js"></script>
  </head>
  <body>
    <h1>Parallel Core War</h1>
    <p>
      <canvas id="canvasCode" width="256" height="256"></canvas>
      <canvas id="canvasOwner" width="256" height="256"></canvas>
    </p>
    <p>
      Instruction counter: <span id="instructionCounter">0</span>
    </p>
    <p>
      <button onclick="reset_core()">Reset</button>
      <button onclick="run_core()">Run</button>
      <button onclick="stop_core()">Stop</button>
      <button onclick="step_core()">Step</button>
    </p>
    <table>
      <tr>
	<td>
	  <textarea cols="50" rows="25" id="sourceCode">; Default ancestor
;
; Strategy: Scan backwards through core to find "5 4 3 2 1".
;           Scan forwards through core to find "1 2 3 4 5".
;           When both are found, copy repeatedly to new location.
;
DAT 5 4 3 2 1

;---------------------------------------------------------------------------

IF 2.2 EQ 2.3 2.4 $5
IF 1.2 NE 1.2 1.4 $5
DAT 0 0 1 0 0
ADD -1.4 1.3 1.4
DAT 0 0 0 0 0
ADD -1.4 2.3 2.4
ADD -2.3 1.2 $0
DAT 0 0 0 0 0
ADD -1.2 17.3 $0
ADD -2.4 10.3 13.3
ADD -3.3 3.3 6.3

IF -9.2 SUB 1.4 1.4 $1
DAT 0 0 0 0 0

DAT 0 0 0 0 0
ADD -1.4 -2.4 $0
EQ -2.3 @-2.4 $5

DAT 0 0 0 0 0
ADD -1.4 -5.4 $-3.1
EQ -2.3 @-2.4 $4

DAT 0 0 0 0 0
ADD -1.4 -8.4 $-6.2
EQ -2.3 @-2.4 $3

DAT 0 0 0 0 0
ADD -1.4 -11.4 $-9.3
EQ -2.3 @-2.4 $2

DAT 0 0 0 0 0
ADD -1.4 -14.4 $-12.4
EQ -2.3 @-2.4 $1

;---------------------------------------------------------------------------

DAT 0 0 0 1 0
ADD -1.2 -27.3 5.3
IF -2.3 NE -2.3 -2.2 $2
SUB 29.2 -3.3 $1

;---------------------------------------------------------------------------

IF 2.2 EQ 2.3 2.4 $5
IF 1.2 NE 1.2 1.4 $5
DAT 0 0 1 0 0
ADD -1.4 1.3 1.4
DAT 0 0 0 0 0
ADD -1.4 2.3 2.4
ADD -2.3 1.2 $0
DAT 0 0 0 0 0
ADD -1.2 17.3 $0
ADD -2.4 10.3 13.3
ADD -3.3 3.3 6.3

IF -9.2 ADD 1.4 1.4 $1
DAT 0 0 0 0 0

DAT 0 0 0 0 0
ADD -1.4 -2.4 $0
EQ -2.3 @-2.4 $1

DAT 0 0 0 0 0
ADD -1.4 -5.4 $-3.1
EQ -2.3 @-2.4 $2

DAT 0 0 0 0 0
ADD -1.4 -8.4 $-6.2
EQ -2.3 @-2.4 $3

DAT 0 0 0 0 0
ADD -1.4 -11.4 $-9.3
EQ -2.3 @-2.4 $4

DAT 0 0 0 0 0
ADD -1.4 -14.4 $-12.4
EQ -2.3 @-2.4 $5

;---------------------------------------------------------------------------

DAT 0 0 0 0 0
IF -1.2 ADD -1.3 -49.4 $-46.2
IF -2.2 ADD -2.4 -18.4 $-16.4
DAT 0 0 1 0 0
IF -1.2 EQ -1.2 -4.2 $0
IF -2.2 NE -2.3 -5.2 $0
IF -3.3 ADD 2.3 -6.3 $-6.0
IF -4.3 SUB 1.4 -7.4 -7.3
DAT 0 0 0 0 0
IF -6.3 ADD -1.2 $0 $1
IF -2.2 ADD -2.3 -2.3 $1
IF -3.2 SUB -3.4 -3.4 $1
IF -4.2 EQ 1.2 -4.4 $0
DAT 0 0 0 0 151
IF -1.2 ADD -6.2 $0 $0
IF -7.2 ADD @-2.4 @-7.3 $0
IF -8.2 ADD -3.4 -3.4 $1
IF -4.2 MUL -4.4 -4.4 $5

;---------------------------------------------------------------------------

DAT 1 2 3 4 5
</textarea>
	</td>
	<td>
	  <textarea cols="65" rows="25" id="dumpArea"></textarea>
	  <br>
	  Lo: <input id="dumpLo" value="0" onchange="dump_range_change()">
	  Hi: <input id="dumpHi" value="0" onchange="dump_range_change()">
	</td>
      </tr>
    </table>
    <script>index_main();</script>
  </body>
</html>
